{% extends "base.html" %}

{% block title %}Restaurant Results - {{ data.location }} - {{ data.mood }}{% endblock %}

{% block content %}
<div class="text-center mb-4">
    <h1 class="display-5 fw-bold text-primary mb-3">
        <i class="fas fa-utensils me-3"></i>Restaurant Results
    </h1>
    <div class="alert alert-success">
        <i class="fas fa-check-circle me-2"></i>
        Found {{ data.total_restaurants }} restaurants in <strong>{{ data.location }}</strong> matching "<strong>{{ data.mood }}</strong>" mood
    </div>
</div>

<div class="text-center mb-4">
    <a href="/" class="btn btn-primary">
        <i class="fas fa-arrow-left me-2"></i>New Search
    </a>
</div>

{% for restaurant in data.restaurants %}
<div class="restaurant-card">
    <div class="restaurant-header">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h3 class="mb-2">{{ restaurant.name }}</h3>
                <div class="d-flex align-items-center mb-2">
                    <span class="rating-stars me-3">
                        {% for i in range(5) %}
                            {% if i < restaurant.rating %}
                                ★
                            {% else %}
                                ☆
                            {% endif %}
                        {% endfor %}
                    </span>
                    <span class="me-3">{{ restaurant.rating }}/5</span>
                    <span class="badge bg-light text-dark">{{ restaurant.review_count }} reviews</span>
                </div>
            </div>
            <div class="col-md-4 text-end">
                <span class="mood-badge">{{ data.mood }}</span>
            </div>
        </div>
    </div>
    
    <div class="restaurant-body">
        <div class="row">
            <div class="col-md-8">
                <div class="mb-3">
                    <h5><i class="fas fa-utensils me-2"></i>{{ restaurant.cuisine }}</h5>
                    <p class="mb-2"><i class="fas fa-map-marker-alt me-2"></i>{{ restaurant.address }}</p>
                    <p class="mb-2"><i class="fas fa-phone me-2"></i>{{ restaurant.phone }}</p>
                    <p class="mb-3"><i class="fas fa-dollar-sign me-2"></i>Price Range: {{ restaurant.price_range }}</p>
                </div>
                
                <div class="mb-3">
                    <h6><i class="fas fa-tags me-2"></i>Categories:</h6>
                    <div class="d-flex flex-wrap">
                        {% for category in restaurant.categories %}
                        <span class="badge bg-secondary me-2 mb-1">{{ category }}</span>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="mb-3">
                    <h6><i class="fas fa-heart me-2"></i>Why it matches your mood:</h6>
                    <p class="text-muted">{{ restaurant.mood_match }}</p>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="text-center mb-3">
                    <img src="{{ restaurant.image_url }}" alt="{{ restaurant.name }}" 
                         class="img-fluid rounded" style="max-height: 200px; width: 100%; object-fit: cover;">
                </div>
                <div class="text-center">
                    <a href="{{ restaurant.url }}" target="_blank" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-external-link-alt me-2"></i>View on Yelp
                    </a>
                </div>
            </div>
        </div>
        
        <hr>
        
        <div class="reviews-section">
            <h5><i class="fas fa-comments me-2"></i>Customer Reviews</h5>
            {% for review in restaurant.reviews %}
            <div class="review-card">
                <div class="d-flex justify-content-between align-items-start mb-2">
                    <div>
                        <strong>{{ review.user_name }}</strong>
                        <span class="rating-stars ms-2">
                            {% for i in range(5) %}
                                {% if i < review.rating %}
                                    ★
                                {% else %}
                                    ☆
                                {% endif %}
                            {% endfor %}
                        </span>
                    </div>
                    <span class="review-source">{{ review.source }}</span>
                </div>
                <p class="mb-2">{{ review.text }}</p>
                <small class="text-muted">{{ review.time_created }}</small>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endfor %}

<div class="text-center mt-4">
    <a href="/" class="btn btn-primary">
        <i class="fas fa-search me-2"></i>Search Again
    </a>
</div>
{% endblock %}
